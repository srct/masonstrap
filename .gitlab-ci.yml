image: node:latest

build:
  script:
    - yarn
    - npm install -g gulp
    - gulp build
  artifacts:
    paths:
      - build/js
      - build/css
  only:
    - master

pages:
  script:
    - yarn
    - npm install -g gulp
    - gulp build
    - mkdir public
    - mv build/* public
  artifacts:
    paths:
      - public
  only:
    - master

deploy:
  image: python:latest
  script:
  - pip install awscli
  - aws s3 cp ./build/ s3://srct/masonstrap/ --recursive
  only:
  - master
